models:
  - name: stg_payments
    description: Staging model applying light transformations to source data
    columns:
      - name: payment_id
        description: A unique key identifying each payment
        tests:
          - unique
          - not_null
      - name: transactionTime
        description: The timestamp for when the payment was completed
        tests:
          - not_null
      - name: transactionMonth
        description: The month on which the payment was completed, represented by the first day of the month
        tests:
          - not_null

  - name: int_payments_periodised
    description: Intermediate model that splits payment data evenly across months
    columns:
      - name: active_from
        description: The first month on which the payment contributes to MRR
        tests:
          - not_null
      - name: active_to
        description: The last month on which the payment contributes to MRR
        tests:
          - not_null
      - name: amount_periodised
        description: The monthly equivalent amount that a payment contributes to MRR
        tests:
          - not_null

  - name: int_dim_months
    description: A dimension model containing a date series with the month starts between 2015 and 2018
    columns:
      - name: metric_month
        description: The date of the first date in each month
        tests:
          - not_null
          - unique

  - name: int_payments_periodised_monthly
    description: Intermediate model that contains, for every month, each user/subscription that was active on that month, together with the periodised monthly revenue

  - name: metric_mrr
    description: Metric model that indicates the monthly recurring revenue and number of monthly subscribers by country and subscription type
    columns:
      - name: metric_month
        description: The month for which MRR is being calculated
        tests:
          - not_null
      - name: billingCountry
        description: A dimension segmenting the metric across countries
        tests:
          - not_null
      - name: product
        description: A dimension segmenting the metric across subscription products
        tests:
          - not_null
      - name: active_subscribers
        description: The number of users with a subscription active on a particular month
        tests:
          - not_null
      - name: mrr
        description: The monthly equivalent revenue (MRR) from subscriptions active on a given month
        tests:
          - not_null